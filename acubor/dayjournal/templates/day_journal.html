{% extends "dashboard.html" %}

{% block title %}Day Journal for {{ day_journal.date }}{% endblock %}

{% block breadcrumbs %}
{{ block.super }}
<li><a href="{% url "all_day_journals_improvised" day_journal.date|date:"Y" %}">Day Journal Register</a></li>
<span class="divider"><i class="icon-angle-right"></i></span>
<li><a href="{% url "new_day_journal" %}">Day Journal</a></li>
{% endblock %}

{% block pageheader %}
Day Journal for {{ day_journal.date }}
{% endblock %}

{% load filters %}
{% block extra-head %}
{% load compress %}
<script src="{{ STATIC_URL }}js/vendors/knockout.js"></script>
{% compress js %}
<script src="{{ STATIC_URL }}js/ko_lib.js"></script>
<script src="{{ STATIC_URL }}js/day_journal.js"></script>
{% endcompress %}

<script type="text/javascript">
        ko_data = {{ day_journal|jsonify }};
        $(document).ready(function () {
            $('.tab-trigger').on('click', function () {
                var open_id = $(this).data('open-id');
                var target = $(this).attr('href');
                var ahref = $('a[href="' + target + '"]').filter(function () {
                    return $(this).data('toggle') == 'tab';
                });
                var col_head = false;
                var el = ahref;
                if (open_id) {
                    col_body = $('#' + open_id).find('.col-box-body');
                    if (col_body.length > 0) {
                        col_body.slideDown();
                        el = col_body.siblings('.col-box-header');
                    }
                }
                $('html, body').stop().animate({
                    'scrollTop': el.offset().top
                }, 900, 'swing', function () {
                    window.location.hash = target;
                });
                $(ahref).tab('show');

            });
        });

</script>
{% endblock %}

{% block controls %}
<!-- Button to trigger modal -->
<a href="#print-preview" data-toggle="modal"><i class="icon-print"></i> Print</a>
{% endblock %}

{% block content %}
<!-- Modal -->
<div id="print-preview" class="modal hide fade do-print" tabindex="-1" role="dialog" aria-labelledby="modal-label"
     aria-hidden="true">
<div class="modal-header no-print">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="modal-label">Print Preview</h3>
</div>
<div class="modal-body">
<p>
    {{ request.user.currently_activated_company }}
</p>
<p>
    Voucher No: <span data-bind="text: voucher_no()"></span> {{ day_journal.date|date:"m-d-Y" }}
</p>
<div class="print-wrap" style="width:8.3in;">
<!-- Cash Summary -->
<div data-bind="with: summary_cash">
    <table class="gridtable" style="width:8.1in;">
        <thead>
        <tr>
            <th colspan="6" style="width:8.1in;">Cash Summary</th>
        </tr>
        <tr>
            <th style="width:1.35in;">Opening</th>
            <th style="width:1.37in;">Inward</th>
            <th style="width:1.35in;">Outward</th>
            <th style="width:1.35in;">Closing</th>
            <th style="width:1.35in;">Actual</th>
            <th style="width:1.35in;">Difference</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum(rows()[0].opening($root))))"></td>
            <td style="text-align:right"  data-bind="text: znum(fnum(rnum(rows()[0].inward($root))))"></td>
            <td style="text-align:right"  data-bind="text: znum(fnum(rnum(rows()[0].outward($root))))"></td>
            <td style="text-align:right"  data-bind="text: znum(fnum(rnum(rows()[0].closing($root))))"></td>
            <td style="text-align:right"  data-bind="text: znum(fnum(rnum(rows()[0].actual())))"></td>
            <td style="text-align:right"  data-bind="text: znum(fnum(rnum(rows()[0].difference($root))))"></td>
        </tr>
        </tbody>
    </table>
</div>
<br/>

<div class="print-half">
    <!-- Sales -->
    <div data-bind="with: cash_sales, visible: cash_sales.has_real_rows('amount')">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="3" style="width:3.9in;">Sales</th>
            </tr>
            <tr>
                <th class="span3" style="width:1.3in;">Sales Ledger</th>
                <th class="span2" style="width:1.3in;">Amount</th>
                <th class="span2" style="width:1.3in;">Tax</th>
            </tr>
            </thead>

            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if:account_id -->
            <tr>
                <!--<td>-->
                <!--<span data-bind="text: $index()+1"> </span>-->
                <!--</td>-->
                <td data-bind="text: $index()+1+'.  ' + $root.account_by_id(account_id()).name"></td>
                <td style="text-align:right;" class="change-on-ready" data-bind="text: znum(fnum(rnum(amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(tax())))"></td>

            </tr>
            <!-- /ko -->
            <!-- /ko -->
            <tr class="dont-validate">
                <td><b>TOTAL</b></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(get_total('amount'))))"></td>
                <td style="text-align:right;" colspan="2" data-bind="text: znum(fnum(rnum(get_total('tax'))))"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>
    {% if request.user.currently_activated_company.settings.lotto_tracking %}
    <!-- Lotto/Scratch-Off Sales -->
    <div data-bind="visible: !(lotto_sales_dispenser_amount() == 0 && $root.scratch_off_total() == 0
                            && lotto_sales_register_amount() ==0 && scratch_off_sales_register_amount() == 0)">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="3" style="width:3.9in;">Lotto/Scratch-Off Sales</th>
            </tr>
            <tr>
                <th class="span3" style="width:1.3in;"></th>
                <th class="span2" style="width:1.3in;">Amount</th>
                <th class="span2" style="width:1.3in;">Tax</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th>Lotto Sales as per Dispenser</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(lotto_sales_dispenser_amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum($root.lotto_sales_dispenser_tax())))"></td>
            </tr>
            <tr>
                <th>Scratch Off Sales as per Dispenser</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum($root.scratch_off_total())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(scratch_off_sales_dispenser_tax())))"></td>
            </tr>
            <tr>
                <th>Lotto Sales as per Register</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(lotto_sales_register_amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum($root.lotto_sales_register_tax())))"></td>
            </tr>
            <tr>
                <th>Scratch Off Sales as per Register</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(scratch_off_sales_register_amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum($root.scratch_off_sales_register_tax())))"></td>
            </tr>
            <tr class="diff">
                <th>Difference</th>
                <td style="text-align:right;"
                    data-bind="text: znum(fnum(rnum(lotto_sales_dispenser_amount() + $root.scratch_off_total()
                    - scratch_off_sales_register_amount() - lotto_sales_register_amount())))"></td>
                <td style="text-align:right;"
                    data-bind="text: znum(fnum(rnum($root.lotto_sales_dispenser_tax() + scratch_off_sales_dispenser_tax()
                    - $root.scratch_off_sales_register_tax() - $root.scratch_off_sales_register_tax())))"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>
    {% endif %}

    <!-- Transfer/Remittance -->
    <div data-bind="with: summary_transfer, visible: summary_transfer.has_real_rows('cash')">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="2" style="width:3.9in;">Transfer/Remittance</th>
            </tr>
            <tr>
                <th class="span4" style="width:1.95in;">Transfer Type</th>
                <th class="span3" style="width:1.95in;">Cash</th>
            </tr>
            </thead>
            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if: transfer_type -->
            <tr>
                <td data-bind="text: $index()+1 + '.  ' + $root.account_by_id(transfer_type()).name"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(cash())))"></td>
            </tr>
            <!-- /ko -->
            <!-- /ko -->
            <tr class="dont-validate">
                <td><b>TOTAL</b></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(get_total('cash'))))"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>

    <!-- Sales Summary -->
    <div>
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="3" style="width:3.9in;">Sales Summary</th>
            </tr>
            <tr>
                <th class="span3" style="width:1.3in;"></th>
                <th class="span2" style="width:1.3in;">Amount</th>
                <th class="span2" style="width:1.3in;">Tax</th>
            </tr>
            </thead>
            <tr>
                <th>Actual Sales</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(actual_sales_amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(actual_sales_tax())))"></td>
            </tr>
            <tr>
                <th>Sales shown by Register</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(register_sales_amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(register_sales_tax())))"></td>
            </tr>
            <tr class="diff">
                <th>Difference</th>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(diff_sales_amount())))"></td>
                <td style="text-align:right;" data-bind="text: znum(fnum(rnum(diff_sales_tax())))"></td>
                <!--<td style="text-align:right;" data-bind="text: znum(fnum(rnum(diff_sales_tax())))"></td>-->
            </tr>
            <tbody>

            </tbody>
        </table>
        <br/>
    </div>

</div>
<div class="print-half print-half-last">
    <!-- Sales Against -->
    <table class="gridtable" style="width:3.9in;">
        <thead>
        <tr>
            <th colspan="3" style="width:3.9in;">Sales Made Through</th>
        </tr>
        <tr>
            <th class="span3" style="width:1.3in;">Ledger</th>
            <th class="span2" style="width:1.3in;">Amount</th>
            <th class="span2" style="width:1.3in;">Commission</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1. Cash</td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum($root.sales_summary_cash())))"></td>
            <td></td>
        </tr>
        <tr>
            <td>2. Card</td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum($root.card_sales.rows()[0].amount())))||''"></td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum($root.card_sales.rows()[0].commission_out())))||''"></td>
        </tr>
        <!-- ko foreach:$root.cash_equivalent_sales.rows() -->
        <!-- ko if:account -->
        <tr>
            <td data-bind="text: $index()+2 + '.  ' + $root.account_by_id(account()).name"></td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum(amount())))||''"></td>
            <td></td>
        </tr>
        <!-- /ko -->
        <!-- /ko -->
        <tr>
            <td><b>TOTAL</b></td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum($root.actual_sales_amount())))"></td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum($root.card_sales.rows()[0].commission_out())))"></td>
        </tr>
        </tbody>
    </table>
    <br/>

    <!-- Vendor Payouts -->
    <div data-bind="with: vendor_payout, visible: vendor_payout.has_real_rows('vendor')">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="2" style="width:3.9in;">Vendor Payouts</th>
            </tr>
            <tr>
                <th class="span4" style="width:1.95in;">Vendor</th>
                <th class="span3" style="width:1.95in;">Amount</th>
            </tr>
            </thead>
            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if:vendor -->
            <tr>
                <td data-bind="text: $index()+1 + '.  ' + $root.account_by_id(vendor()).name"></td>
                <td data-bind="text: znum(fnum(rnum(amount())))" style="text-align:right;"></td>
            </tr>
            <!-- /ko -->
            <!-- /ko -->
            <tr class="dont-validate">
                <td><b>TOTAL</b></td>
                <td data-bind="text: znum(fnum(rnum(get_total('amount'))))" style="text-align:right;"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>

    <!-- Other Payout -->
    <div data-bind="with: other_payout, visible: other_payout.has_real_rows('paid_to')">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="2" style="width:3.9in;">Other Payout</th>
            </tr>
            <tr>
                <th class="span4" style="width:1.95in;">Paid To</th>
                <th class="span3" style="width:1.95in;">Amount</th>
            </tr>
            </thead>

            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if:paid_to -->
            <tr>
                <td data-bind="text: $index()+1 + '.  ' + $root.account_by_id(paid_to()).name"></td>
                <td data-bind="text: znum(fnum(rnum(amount())))" style="text-align:right;"></td>
            </tr>
            <!-- /ko -->
            <!-- /ko -->
            <tr class="dont-validate">
                <td><b>TOTAL</b></td>
                <td data-bind="text: znum(fnum(rnum(get_total('amount'))))" style="text-align:right;"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>

    <!-- Vendor Charge -->
    <div data-bind="with: vendor_charge, visible: vendor_charge.has_real_rows('purchase_ledger')">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="3" style="width:3.9in;">Vendor Charge</th>
            </tr>
            <tr>
                <th class="span3" style="width:1.3in;">Vendor</th>
                <th class="span2" style="width:1.3in;">Amount</th>
                <th class="span2" style="width:1.3in;">Purchase Ledger</th>
            </tr>
            </thead>
            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if:purchase_ledger -->

            <tr>
                <td data-bind="text: $index()+1 + '.  ' + $root.account_by_id(vendor()).name">
                </td>
                <td style="text-align:right" data-bind="text: znum(fnum(rnum(amount())))"></td>
                <td data-bind="text: $root.account_by_id(purchase_ledger()).name">
                </td>

            </tr>
            <!-- /ko -->
            <!-- /ko -->
            <tr class="dont-validate">
                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                <td style="text-align:right" data-bind="text: znum(fnum(rnum(get_total('amount'))))" colspan="1"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>

    <!-- Deposits -->
    <div data-bind="with: deposits, visible: deposits.has_real_rows('deposit_in')">
        <table class="gridtable" style="width:3.9in;">
            <thead>
            <tr>
                <th colspan="3" style="width:3.9in;">Deposits</th>
            </tr>
            <tr>
                <th class="span3" style="width:1.3in;">Deposit In</th>
                <th class="span2" style="width:1.3in;">Deposit From</th>
                <th class="span2" style="width:1.3in;">Amount</th>
            </tr>
            </thead>
            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if:deposit_in -->
            <tr>
                <td data-bind="text: $index()+1 + '. ' + $root.account_by_id(deposit_in()).name">
                </td>
                <td data-bind="text: $root.account_by_id(deposit_from()).name">
                </td>
                <td style="text-align:right" data-bind="text: znum(fnum(rnum(amount())))"></td>

            </tr>
            <!-- /ko -->
            <!-- /ko -->
            <tr class="dont-validate">
                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                <td style="text-align:right" colspan="1" data-bind="text: znum(fnum(rnum(get_total('amount'))))"></td>
            </tr>
            </tbody>
        </table>
        <br/>
    </div>
</div>
</div>
{% if request.user.currently_activated_company.settings.inventory_tracking %}
<div class="page-break" data-bind="visible: summary_inventory.has_real_rows('item_id')||inventory_fuel.has_real_rows('item_id')"></div>
<div class="print-wrap" style="width:8.3in;" data-bind="visible: summary_inventory.has_real_rows('item_id')||inventory_fuel.has_real_rows('item_id')">
    <p>
        {{ request.user.currently_activated_company }}
    </p>
    <p>
        Voucher No: <span data-bind="text: voucher_no()"></span> {{ day_journal.date|date:"m-d-Y" }}
    </p>
    {% if request.user.currently_activated_company.settings.company_type == "Gas Station and Store" or request.user.currently_activated_company.settings.company_type == "Gas Station" %}
    <!-- Fuel -->
    <div data-bind="with: inventory_fuel, visible: inventory_fuel.has_real_rows('item_id')">
        <table class="gridtable" style="width:8.1in;">
            <thead>
            <tr>
                <th colspan="7" style="width:8.1in;">Daily Fuel Report</th>
            </tr>
            <tr>
                <th class="span4" style="width:1.2in;">Particulars</th>
                <th class="span2" style="width:1.15in;">Opening</th>
                <th class="span2" style="width:1.15in;">Purchase</th>
                <th class="span2" style="width:1.15in;">Sales</th>
                <th class="span2" style="width:1.15in;">Closing</th>
                <th class="span2" style="width:1.15in;">Actual</th>
                <th class="span2" style="width:1.15in;">Difference</th>
            </tr>
            </thead>
            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if: item_id -->
            <tr>
                <td data-bind="text: $index()+1 + '.  ' + $root.inventory_item_by_id(item_id()).name"></td>
                <td data-bind="text: znum(fnum(rnum(opening()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(purchase()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(sales()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(closing()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(actual()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(difference()))) + ' ' + $root.get_unit(item_id())"></td>
            </tr>
            <!-- /ko -->
            <!-- /ko -->
            </tbody>
        </table>
        <br/>
    </div>
    {% endif %}
    <!-- Other Inventories -->
    <div class="row-fluid" data-bind="with: summary_inventory, visible: summary_inventory.has_real_rows('item_id')">
        <table class="gridtable" style="width:8.1in;">
            <thead>
            <tr>
                <th colspan="7" style="width:8.1in;">Daily Other Inventories Report</th>
            </tr>
            <tr>
                <th class="span4" style="width:1.2in;">Particulars</th>
                <th class="span2" style="width:1.15in;">Opening</th>
                <th class="span2" style="width:1.15in;">Purchase</th>
                <th class="span2" style="width:1.15in;">Sales</th>
                <th class="span2" style="width:1.15in;">Closing</th>
                <th class="span2" style="width:1.15in;">Actual</th>
                <th class="span2" style="width:1.15in;">Difference</th>
            </tr>
            </thead>
            <tbody>
            <!-- ko foreach: rows -->
            <!-- ko if: item_id -->
            <tr>
                <td data-bind="text: $index()+1 + '.  ' + $root.inventory_item_by_id(item_id()).name"></td>
                <td data-bind="text: znum(fnum(rnum(opening()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(purchase()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(sales()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(closing()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(actual()))) + ' ' + $root.get_unit(item_id())"></td>
                <td data-bind="text: znum(fnum(rnum(difference()))) + ' ' + $root.get_unit(item_id())"></td>
            </tr>
            <!-- /ko -->
            <!-- /ko -->
            </tbody>
        </table>
        <br/>
    </div>
    {% endif %}
</div>
<div class="modal-footer no-print">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <a href="javascript: window.print();" class="btn btn-primary">Print</a>
</div>
</div>
</div>
<div class="no-print page-journal">
<div class="row-fluid">
    <div class="pull-left">
        Voucher No.: <input type="text" data-bind="value: voucher_no">
    </div>
    <div class="pull-right">
        <input type="text" id="day-journal-date" class="date-picker" placeholder="Pick a date..."/>
        <button id="day-journal-selection-button" class="btn btn-mini">Go</button>
    </div>
</div>

<div class="row-fluid">
    {% ifusergroup 'Owner' 'SuperOwner' 'Supervisor' %}
    <div class="pull-left">
        {% if approved %}
        <a href="/day/unapprove/{{ day_journal.date|date:'Y-m-d'}}/" class="btn">Unapprove</a>
        {% else %}
        <a href="javascript: vm.approve()" class="btn">Approve</a>
        {% endif %}
    </div>
    <div class="pull-right">
        <a href="/day/delete/{{ day_journal.date|date:'Y-m-d'}}/" class="btn btn-danger">Delete</a>
    </div>
    {% endifusergroup %}
</div>
<br/>
<br/>
<div class="col-box" id="sales_col_box">
<div class="col-box-header">
    <a href="#">
        <h3><i class="icon-money"></i> Sales <i class="icon-chevron-up pull-right status-handle"></i></h3>
    </a>
</div>
<div class="col-box-body">
<!-- Cash Tab -->
<div class="tabbable">
<ul class="nav nav-tabs" id="cash-tab">
    <li class="active">
        <a data-toggle="tab" href="#cash-sales-div">
            Sales
        </a>
    </li>
    <li>
        <a data-toggle="tab" href="#summary-transfer-div">
            Transfers/Remittance
        </a>
    </li>
</ul>
<div class="tab-content">

<div id="cash-sales-div" class="tab-pane active">
<div class="row-fluid" data-bind="with: cash_sales">
    <table id="cash-sales-table" class="table table-bordered table-striped table-acubor table-sortable">
        <thead>
        <tr>
            <th class="span1">SN</th>
            <th class="span2">Sales Ledger</th>
            <th class="span2">Amount</th>
            <th class="span2">Tax</th>
            <th class="span1"></th>
        </tr>
        </thead>

        <tbody id="cash-sales">
        <!-- ko foreach: rows -->
        <tr data-bind="flash: true">
            <td>
                <span data-bind="text: $index()+1"> </span>
            </td>
            <td class="with_ip">
                <input type="hidden" data-url="{% url 'create_sales' %}"
                       data-to="accounts" data-name="Sales Ledger"
                       data-bind="value: account_id, select2: $root.sales_sans_lotto(), event: {change: $root.account_changed}">
            </td>
            <td><input target="inside_td" style="text-align:right" class="change-on-ready"
                       data-bind="eval: amount, value: amount, select_all_text:amount "/></td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum(tax())))"></td>
            <td align="center">
                <button type="button" class="btn-none" data-bind="click: $parent.removeRow">
                    <i class="icon-trash"></i>
                </button>
            </td>
        </tr>
        <!-- /ko -->
        <tr class="dont-validate">
            <td colspan="2"><b>TOTAL</b></td>
            <td style="text-align:right" data-bind="text: znum(fnum(get_total('amount')))"></td>
            <td style="text-align:right" data-bind="text: znum(fnum(get_total('tax')))"></td>
        </tr>
        </tbody>
    </table>
    <div data-bind="css: state()" class="pull-left">
                                          <span data-bind="text: message(), css: state()">
                                          </span>
    </div>
    <div class="pull-right">
        <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i> Add
            New Row
        </button>
        <button id="sales-save" class="btn btn-small" data-bind="click: save"><i class="icon-save"></i> Save
        </button>

    </div>
</div>
<br>
{% if request.user.currently_activated_company.settings.lotto_tracking %}
<table id="lotto-sales-table" class="table table-bordered table-striped table-acubor table-sortable">
    <thead>
    <tr>
        <th></th>
        <th>Amount</th>
        <th>Tax</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>Lotto Sales as per Dispenser</td>
        <td><input target="inside_td" style="text-align:right"
                   data-bind="eval:lotto_sales_dispenser_amount, value: lotto_sales_dispenser_amount"
                   class="change-on-ready"/></td>
        <td style="text-align:right" data-bind="text: znum(fnum($root.lotto_sales_dispenser_tax()))"></td>
    </tr>
    <tr>
        <td>Scratch Off Sales as per Dispenser</td>
        <td style="text-align:right" data-bind="text: znum(fnum($root.scratch_off_total()))"></td>
        <td style="text-align:right" data-bind="text: znum(fnum(scratch_off_sales_dispenser_tax()))"></td>
    </tr>
    <tr>
        <td>Lotto Sales as per Register</td>
        <td><input target="inside_td" style="text-align:right"
                   data-bind="eval: lotto_sales_register_amount, value: lotto_sales_register_amount "/></td>
        <td style="text-align:right" data-bind="text: znum(fnum($root.lotto_sales_register_tax()))"></td>
    </tr>
    <tr>
        <td>Scratch Off Sales as per Register</td>
        <td><input target="inside_td" style="text-align:right"
                   data-bind="eval: scratch_off_sales_register_amount,value: scratch_off_sales_register_amount "/></td>
        <td style="text-align:right" data-bind="text: znum(fnum($root.scratch_off_sales_register_tax()))"></td>
    </tr>
    </tbody>
</table>

<span id="lotto-sales-message"></span>
<button id="lotto-sales-as-per-dispenser" class="btn btn-small pull-right"
        data-bind="click: save_lotto_sales_as_per_dispenser"><i
        class="icon-save"></i> Save
</button>

<br><br>
{% endif %}
<table id="actual-sales-table" class="table table-bordered table-striped table-acubor table-sortable">
    <thead>
    <tr>
        <th></th>
        <th>Amount</th>
        <th>Tax</th>
    </tr>
    </thead>
    <tr>
        <th>Actual Sales</th>
        <td style="text-align:right" data-bind="text: znum(fnum(actual_sales_amount()))"></td>
        <td style="text-align:right" data-bind="text: znum(fnum(actual_sales_tax()))"></td>
    </tr>
    <tr>
        <th>Sales shown by Register</th>
        <td><input target="inside_td" style="text-align:right"
                   data-bind="eval: register_sales_amount,value: register_sales_amount"/></td>
        <td><input target="inside_td" style="text-align:right"
                   data-bind="eval: register_sales_tax,value: register_sales_tax"/></td>
    </tr>
    <tr class="diff">
        <th>Difference</th>
        <td style="text-align:right" data-bind="text: znum(fnum(diff_sales_amount()))"></td>
        <td style="text-align:right" data-bind="text: znum(fnum(diff_sales_tax()))"></td>
    </tr>
    <tbody>

    </tbody>

</table>

<span id="sales-register-message"></span>

<button id="summary-sales-tax-save" class="btn btn-small pull-right" data-bind="click: save_sales_register">
    <i class="icon-save"></i> Save
</button>

<h3>Sales through Cards</h3>

<div class="row-fluid" data-bind="with: card_sales">
    <table id="sales-through-cards-table" class="table table-bordered table-striped table-acubor table-sortable">
        <thead>
        <tr>
            <th class="span2">Gross Amount</th>
            <th class="span2">Commission Out</th>
            <th class="span2">Net Amount</th>
        </tr>
        </thead>

        <tbody id="card-sales">
        <!-- ko foreach: rows -->
        <tr>
            <td><input target="inside_td" style="text-align:right" data-bind="eval: amount, value: amount "/></td>
            <td><input target="inside_td" style="text-align:right"
                       data-bind="eval: commission_out,value: commission_out"/></td>
            <td style="text-align:right" data-bind="text: znum(fnum(rnum(net())))"></td>
        </tr>
        <!-- /ko -->
        </tbody>
    </table>
    <div data-bind="css: state" class="pull-left">
                                    <span data-bind="text: message(), css: state">
                                    </span>
    </div>
    <div class="pull-right">
        <button id="card-sales-save" class="btn btn-small" data-bind="click: save"><i class="icon-save"></i> Save
        </button>
    </div>
</div>

<h3>Sales through Others</h3>

<div class="row-fluid" data-bind="with: cash_equivalent_sales">
    <table id="sales-through-others-table" class="table table-bordered table-striped table-acubor table-sortable">
        <thead>
        <tr>
            <th>SN</th>
            <th>Particular</th>
            <th>Amount</th>
            <th></th>
        </tr>
        </thead>

        <tbody id='cash-equivalent-sales'>
        <!-- ko foreach: rows -->
        <tr data-bind="flash: true">
            <td data-bind="text: $index()+1"></td>
            <td class="with_ip">
                <input type="hidden" data-url="{% url 'create_cash_equivalent' %}" data-to="accounts"
                       data-bind="value: account, select2: $root.accounts_by_category('Cash Equivalent Account')">
            </td>
            <td><input target="inside_td" style="text-align:right" data-bind="eval: amount,value: amount "/></td>
            <td>
                <button type="button" class="btn-none" data-bind="click: $parent.removeRow"><i
                        class="icon-trash"></i>
                </button>
            </td>
        </tr>
        <!-- /ko -->
        <tr class="dont-validate">
            <td colspan="2" style="text-align:center"><b>TOTAL</b></td>

            <td style="text-align:right" data-bind="text: znum(fnum(get_total('amount')))"></td>
        </tr>
        </tbody>
    </table>
    <div data-bind="css: state()" class="pull-left">
                                <span data-bind="text: message()">
                                </span>
    </div>
    <div class="pull-right">
        <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
            Add New Row
        </button>
        <button id="cash_equivalent_sales-save" class="btn btn-small" data-bind="click: save"><i class="icon-save"></i>
            Save
        </button>
    </div>
</div>

</div>

<div id="summary-transfer-div" class="tab-pane">
    <div class="row-fluid" data-bind="with: summary_transfer">
        <table id="transfer-table" class="table table-bordered table-striped table-acubor table-sortable">
            <thead>
            <tr>
                <th>SN</th>
                <th>Transfer Type</th>
                <th>Cash</th>
                <th>Commission</th>
                <th></th>
            </tr>
            </thead>
            <tbody id="summary-transfer">
            <!-- ko foreach: rows -->
            <tr data-bind="flash: true">
                <td data-bind="text: $index()+1"></td>
                <td class="with_ip">
                    <input type="hidden"
                           data-url="{% url 'create_transfer_remittance' %}"
                           data-to="accounts"
                           data-bind="value: transfer_type, select2: $root.accounts_by_category('Transfer and Remittance')">
                </td>
                <td><input target="inside_td" style="text-align:right" data-bind="eval: cash, value: cash "/></td>
                <td><input target="inside_td" style="text-align:right"
                           data-bind="eval: commission, value: commission "/></td>
                <td>
                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow">
                        <i class="icon-trash"></i>
                    </button>
                </td>
            </tr>
            <!-- /ko -->
            <tr class="dont-validate">
                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                <td style="text-align:right" data-bind="text: znum(fnum(get_total('cash')))"></td>
                <td style="text-align:right" data-bind="text: znum(fnum(get_total('commission')))"></td>
            </tr>
            </tbody>
        </table>
        <div data-bind="css: state()" class="pull-left">
                                          <span data-bind="text: message()">
                                          </span>
        </div>
        <div class="pull-right">
            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i> Add
                New Row
            </button>
            <button id="summary-transfer-save" class="btn btn-small" data-bind="click: save"><i class="icon-save"></i>
                Save
            </button>
        </div>
    </div>
</div>
</div>
</div>
<!-- EOF Cash Tab -->
</div>
</div>
<br>

<div class="col-box" id="payout_col_box">
    <div class="col-box-header">
        <a href="#">
            <h3><i class="icon-retweet"></i> Payouts <i class="icon-chevron-up pull-right status-handle"></i></h3>
        </a>
    </div>
    <div class="col-box-body">
        <div class="tabbable">
            <ul class="nav nav-tabs" id="credit-tab">
                <li class="active">
                    <a data-toggle="tab" href="#vendor-payout-div">
                        Vendor Payouts
                    </a>
                </li>

                <li>
                    <a data-toggle="tab" href="#other-payout-div">
                        Other Payouts
                    </a>
                </li>

            </ul>
            <div class="tab-content">
                <div id="vendor-payout-div" class="tab-pane active">
                    <div class="row-fluid" data-bind="with: vendor_payout">
                        <table id="vendor-payout-table"
                               class="table table-bordered table-striped table-acubor table-sortable">
                            <thead>
                            <tr>
                                <th class="span1">SN</th>
                                <th class="span2">Vendor</th>
                                <th class="span2">Amount</th>
                                <th class="span2">Purchase Ledger</th>
                                <th class="span2">Remarks</th>
                                <th class="span2">Paid</th>
                                <th class="span2">Type</th>
                                <th class="span1"></th>
                            </tr>
                            </thead>
                            <tbody id="vendor-payout">
                            <!-- ko foreach: rows -->
                            <tr data-bind="flash: true">
                                <td>
                                    <span data-bind="text: $index()+1"> </span>
                                </td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_suppliers' %}"
                                           data-to="accounts"
                                           data-bind="value: vendor, select2: $root.accounts_by_category('Suppliers')">
                                </td>
                                <td><input target="inside_td" style="text-align:right"
                                           data-bind="eval: amount, value: amount"/></td>
                                <td class="with_ip">
                                    <input type="hidden"
                                           data-url="{% url 'create_purchase' %}"
                                           data-to="accounts"
                                           data-bind="value: purchase_ledger, select2: $root.accounts_by_category('Purchase')">
                                </td>
                                <td><input target="inside_td" data-bind="value: remarks"/></td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_cash_account' %}" data-to="accounts"
                                           data-bind="value: paid, select2: $root.accounts_by_category(['Cash Account', 'Bank Account', 'Cash Equivalent Account'], true)">
                                </td>
                                <td class="with_ip">
                                    <select data-bind="options: types, optionsText:'name', optionsValue: 'id', value: type">
                                    </select>
                                </td>
                                <td>
                                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow">
                                        <i class="icon-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- /ko -->
                            <tr class="dont-validate">
                                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                                <td style="text-align:right" data-bind="text: znum(fnum(get_total('amount')))"></td>
                            </tr>
                            </tbody>
                        </table>
                        <div data-bind="css: state()" class="pull-left">
                                          <span data-bind="text: message()">
                                          </span>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
                                Add New Row
                            </button>
                            <button id="vendor-payout-save" class="btn btn-small" data-bind="click: save"><i
                                    class="icon-save"></i> Save
                            </button>
                        </div>
                    </div>
                </div>
                <div id="other-payout-div" class="tab-pane">
                    <div class="row-fluid" data-bind="with: other_payout">
                        <table id="other-payout-table"
                               class="table table-bordered table-striped table-acubor table-sortable">
                            <thead>
                            <tr>
                                <th class="span1">SN</th>
                                <th class="span2">Paid To</th>
                                <th class="span2">Amount</th>
                                <th class="span2">Remarks</th>
                                <th class="span2">Paid</th>
                                <th class="span1"></th>
                            </tr>
                            </thead>

                            <tbody id="other-payout">
                            <!-- ko foreach: rows -->
                            <tr data-bind="flash: true">
                                <td>
                                    <span data-bind="text: $index()+1"> </span>
                                </td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_account' %}" data-to="accounts"
                                           data-bind="value: paid_to, select2: $root.accounts_except_category(['Sales', 'Purchase', 'Cash Account', 'Cash Equivalent Account', 'Bank Account', 'Suppliers'], true)">
                                </td>
                                <td><input target="inside_td" style="text-align:right"
                                           data-bind="eval: amount, value: amount "/></td>
                                <td><input target="inside_td" data-bind="value: remarks"/></td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_account' %}" data-to="accounts"
                                           data-bind="value: paid, select2: $root.accounts_by_category(['Cash Account', 'Bank Account', 'Cash Equivalent Account'], true)">
                                </td>
                                <td>
                                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow">
                                        <i class="icon-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- /ko -->
                            <tr class="dont-validate">
                                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                                <td style="text-align:right" data-bind="text: znum(fnum(get_total('amount')))"></td>
                            </tr>
                            </tbody>
                        </table>
                        <div data-bind="css: state()" class="pull-left">
                                      <span data-bind="text: message()">
                                      </span>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
                                Add New Row
                            </button>
                            <button id="other-payout-save" class="btn btn-small" data-bind="click: save"><i
                                    class="icon-save"></i> Save
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br>

<div class="col-box" id="charge_col_box">
    <div class="col-box-header">
        <a href="#">
            <h3><i class="icon-folder-open"></i>Others <i class="icon-chevron-up pull-right status-handle"></i></h3>
        </a>
    </div>
    <div class="col-box-body">
        <div class="tabbable">
            <ul class="nav nav-tabs" id="charge-tab">
                <li class="active">
                    <a data-toggle="tab" href="#vendor-charge-div">
                        Vendor Charge
                    </a>
                </li>
                <li>
                    <a data-toggle="tab" href="#deposits-div">
                        Deposits
                    </a>
                </li>
            </ul>
            <div class="tab-content">
                <div id="vendor-charge-div" class="tab-pane active">
                    <div class="row-fluid" data-bind="with: vendor_charge">
                        <table id="vendor-charge-table"
                               class="table table-bordered table-striped table-acubor table-sortable">
                            <thead>
                            <tr>
                                <th class="span1">SN</th>
                                <th class="span2">Vendor</th>
                                <th class="span2">Amount</th>
                                <th class="span2">Purchase Ledger</th>
                                <th class="span2">Remarks</th>
                                <th class="span1"></th>
                            </tr>
                            </thead>
                            <tbody id="vendor-charge">
                            <!-- ko foreach: rows -->
                            <tr data-bind="flash: true">
                                <td>
                                    <span data-bind="text: $index()+1"> </span>
                                </td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_suppliers' %}"
                                           data-to="accounts"
                                           data-bind="value: vendor, select2: $root.accounts_by_category('Suppliers')">
                                </td>
                                <td><input target="inside_td" style="text-align:right"
                                           data-bind="eval: amount,value: amount"/></td>
                                <td class="with_ip">
                                    <input type="hidden"
                                           data-url="{% url 'create_purchase' %}"
                                           data-to="accounts"
                                           data-bind="value: purchase_ledger, select2: $root.accounts_by_category('Purchase')">
                                </td>
                                <td><input target="inside_td" data-bind="value: remarks"/></td>
                                <td>
                                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow">
                                        <i class="icon-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- /ko -->
                            <tr class="dont-validate">
                                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                                <td style="text-align:right" data-bind="text: fnum(get_total('amount'))"></td>
                            </tr>
                            </tbody>
                        </table>
                        <div data-bind="css: state()" class="pull-left">
                                      <span data-bind="text: message()">
                                      </span>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
                                Add New Row
                            </button>
                            <button id="vendor-charge-save" class="btn btn-small" data-bind="click: save"><i
                                    class="icon-save"></i> Save
                            </button>
                        </div>
                    </div>
                </div>

                <div id="deposits-div" class="tab-pane">
                    <div class="row-fluid" data-bind="with: deposits">
                        <table id="deposit-table"
                               class="table table-bordered table-striped table-acubor table-sortable">
                            <thead>
                            <tr>
                                <th class="span1">SN</th>
                                <th class="span2">Deposit In</th>
                                <th class="span2">Amount</th>
                                <th class="span2">Deposit From</th>
                                <th class="span2">Remarks</th>
                                <th class="span1"></th>
                            </tr>
                            </thead>
                            <tbody id="deposits">
                            <!-- ko foreach: rows -->
                            <tr data-bind="flash: true">
                                <td>
                                    <span data-bind="text: $index()+1"> </span>
                                </td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_bank_account' %}"
                                           data-to="accounts"
                                           data-bind="value: deposit_in, select2: $root.accounts_by_category('Bank Account')">
                                </td>
                                <td><input target="inside_td" style="text-align:right"
                                           data-bind="eval: amount,value: amount"/></td>
                                <td class="with_ip">
                                    <input type="hidden" data-url="{% url 'create_account' %}"
                                           data-to="accounts"
                                           data-bind="value: deposit_from, select2: $root.accounts_by_category_list(['Bank Account', 'Cash Account', 'Cash Equivalent Account'])">
                                </td>
                                <td><input target="inside_td" data-bind="value: remarks"/></td>
                                <td>
                                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow">
                                        <i class="icon-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            <!-- /ko -->
                            <tr class="dont-validate">
                                <td style="text-align:center" colspan="2"><b>TOTAL</b></td>
                                <td style="text-align:right" data-bind="text: fnum(get_total('amount'))"></td>
                            </tr>
                            </tbody>
                        </table>
                        <div data-bind="css: state()" class="pull-left">
                                      <span data-bind="text: message()">
                                      </span>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
                                Add New Row
                            </button>
                            <button id="deposits-save" class="btn btn-small" data-bind="click: save"><i
                                    class="icon-save"></i> Save
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br/>
{% if request.user.currently_activated_company.settings.inventory_tracking %}
<div class="col-box" id="inventory_col_box">
    <div class="col-box-header">
        <a href="#">
            <h3><i class="icon-briefcase"></i> Inventories <i class="icon-chevron-up pull-right status-handle"></i>
            </h3>
        </a>
    </div>
    <div class="col-box-body">
        <!-- Inventory Tabs -->
        <div class="tabbable">
            <ul class="nav nav-tabs" id="inventory_tab">
                {% if request.user.currently_activated_company.settings.company_type == "Gas Station and Store" or request.user.currently_activated_company.settings.company_type == "Gas Station" %}
                <li>
                    <a data-toggle="tab" href="#inventory-fuel-tab">
                        Fuel
                    </a>
                </li>
                {% endif %}
                <li class="active">
                    <a data-toggle="tab" href="#summary-invent">
                        Other Inventories
                    </a>
                </li>

            </ul>
            <div class="tab-content">
                {% if request.user.currently_activated_company.settings.company_type == "Gas Station and Store" or request.user.currently_activated_company.settings.company_type == "Gas Station" %}
                <div id="inventory-fuel-tab" class="tab-pane">
                    <div class="row-fluid" data-bind="with: inventory_fuel">
                        <table id="fuel-table" class="table table-bordered table-striped table-acubor table-sortable">
                            <thead>
                            <tr>
                                <th>SN</th>
                                <th>Particulars</th>
                                <th>Unit</th>
                                <th>Opening</th>
                                <th>Purchase</th>
                                <th>Sales</th>
                                <th>Closing</th>
                                <th>Actual</th>
                                <th>Difference</th>
                                <th></th>
                            </tr>
                            </thead>

                            <tbody id="inventory-fuel">

                            <!-- ko foreach: rows -->
                            <tr data-bind="flash: true">
                                <td data-bind="text: $index()+1"></td>
                                <td class="with_ip">
                                    <input type="hidden" data-name="Fuel and Gas Item" data-to="inventory_items"
                                           class="change-on-ready"
                                           data-url="/inventory/create_item/{{ fuel_and_gas.id }}"
                                           data-bind="value: item_id, select2: $root.inventory_items_by_category({{ fuel_and_gas.id }}), event:{change: $root.inventory_item_changed}">
                                </td>
                                <td data-bind="text: $root.get_unit(item_id())"></td>
                                <td data-bind="text: znum(fnum(opening()))"></td>
                                <td><input target="inside_td" data-bind="eval_for_fuels: purchase,value: purchase "/></td>
                                <td><input target="inside_td" data-bind="eval_for_fuels: sales,value: sales "/></td>
                                <td data-bind="text: znum(fnum(closing()))"></td>
                                <td><input target="inside_td" data-bind=" eval_for_fuels: actual, value: actual"/></td>
                                <td data-bind="text: znum(fnum(difference()))"></td>
                                <td>
                                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow"><i
                                            class="icon-trash"></i></button>
                                </td>
                            </tr>
                            <!-- /ko -->
                            </tbody>
                        </table>
                        <div data-bind="css: state()" class="pull-left">
                                        <span data-bind="text: message()">
                                        </span>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
                                Add New Row
                            </button>
                            <button id="inventory-fuel-save" class="btn btn-small" data-bind="click: save"><i class="icon-save"></i>
                                Save
                            </button>
                        </div>
                    </div>
                </div>
                {% endif %}
                <div id="summary-invent" class="tab-pane active">
                    <div class="row-fluid" data-bind="with: summary_inventory">
                        <table id="other-inventory-table" class="table table-bordered table-striped table-acubor table-sortable">
                            <thead>
                            <tr>
                                <th>SN</th>
                                <th>Particulars</th>
                                <th>Unit</th>
                                <th>Opening</th>
                                <th>Purchase</th>
                                <th>Sales</th>
                                <th>Closing</th>
                                <th>Actual</th>
                                <th>Difference</th>
                                <th></th>
                            </tr>
                            </thead>

                            <tbody id="summary-inventory">

                            <!-- ko foreach: rows -->
                            <tr data-bind="flash: true">
                                <td data-bind="text: $index()+1"></td>
                                <td class="with_ip">
                                    <input type="hidden" data-name="Inventory Item" data-to="inventory_items"
                                           class="change-on-ready"
                                           data-url="{% url 'create_inventory_item_returning_item_no_fuel' %}"
                                           data-bind="value: item_id, select2: $root.inventory_items_except_category({{ fuel_and_gas.id }}), event: {change: $root.inventory_item_changed}">
                                </td>
                                <td data-bind="text: $root.get_unit(item_id())"></td>
                                <td data-bind="text: znum(fnum(opening()))"></td>
                                <td><input target="inside_td" data-bind="eval_for_fuels: purchase,value: purchase"/></td>
                                <td><input target="inside_td" data-bind=" eval_for_fuels: sales,value: sales"/></td>
                                <td data-bind="text: znum(fnum(closing()))"></td>
                                <td><input target="inside_td" data-bind=" eval_for_fuels: actual,value: actual"/></td>
                                <td data-bind="text: znum(fnum(difference()))"></td>
                                <td>
                                    <button type="button" class="btn-none" data-bind="click: $parent.removeRow"><i
                                            class="icon-trash"></i></button>
                                </td>
                            </tr>
                            <!-- /ko -->
                            </tbody>
                        </table>
                        <div data-bind="css: state()" class="pull-left">
                                        <span data-bind="text: message()">
                                        </span>
                        </div>
                        <div class="pull-right">
                            <button class="btn btn-small" data-bind="click: addRow"><i class="icon-plus-sign"></i>
                                Add New
                                Row
                            </button>
                            <button id="summary-inventory-save" class="btn btn-small" data-bind="click: save"><i
                                    class="icon-save"></i> Save
                            </button>
                        </div>
                    </div>
                </div>



            </div>
        </div>
        <!-- EOF Inventory Tabs -->
    </div>
</div>
<br>
{% endif %}
<!-- Summary Tabs -->
<div class="tabbable">
    <ul class="nav nav-tabs" id="summary-tab">
        <li class="active">
            <a data-toggle="tab" href="#summary-cash">
                Summary Cash
            </a>
        </li>
    </ul>
    <div class="tab-content">

        <div id="summary-cash" class="tab-pane active">
            <div class="row-fluid" data-bind="with: summary_cash">
                <table class="table table-bordered table-striped table-acubor table-sortable">
                    <thead>
                    <tr>
                        <th class="span2">Opening</th>
                        <th class="span2">Inward</th>
                        <th class="span2">Outward</th>
                        <th class="span2">Closing</th>
                        <th class="span2">Actual</th>
                        <th class="span2">Difference</th>
                    </tr>
                    </thead>
                    <tbody id="summary-cash-body">
                    <tr>
                        <td style="text-align:right" data-bind="text: znum(fnum(rows()[0].opening($root)))"></td>
                        <td style="text-align:right" data-bind="text: znum(fnum(rows()[0].inward($root)))"></td>
                        <td style="text-align:right" data-bind="text: znum(fnum(rows()[0].outward($root)))"></td>
                        <td style="text-align:right" data-bind="text: znum(fnum(rows()[0].closing($root)))"></td>
                        <td><input target="inside_td" data-bind="eval:rows()[0].actual, value: rows()[0].actual"/></td>
                        <td style="text-align:right" data-bind="text: znum(fnum(rows()[0].difference($root)))"></td>
                    </tr>
                    </tbody>
                </table>
                <div data-bind="css: state()" class="pull-left"><span data-bind="text: message()"></span></div>
                <div class="pull-right">
                    <button id="summary-cash-save" class="btn btn-small" data-bind="click: save"><i
                            class="icon-save"></i> Save
                    </button>
                </div>
            </div>
        </div>

    </div>
</div>
<!-- EO Summary Tabs -->

<!-- Attachment Tabs -->
<div class="tabbable" id="attachment_tabbable" data-journal-day="{{ day_journal.date|date:"Y-m-d" }}">
<ul class="nav nav-tabs" id="attachment-tab">
    <li class="active">
        <a data-toggle="tab" href="#sales_attach">Sales Attachments</a>
    </li>
    <li>
        <a data-toggle="tab" href="#purchase_attach">Purchase Attachments</a>
    </li>
    <li>
        <a data-toggle="tab" href="#bank_attach">Bank Attachments</a>
    </li>
    <li>
        <a data-toggle="tab" href="#other_attach">Other Attachments</a>

    </li>
</ul>
<div class="tab-content">
    <div id="sales_attach" class="tab-pane active">
        <form class="attachment-form" data-type="sales">
            <div class="row-fluid">
                {% for attachment in sales_attachments %}
                <div class="span3">
                    <a target="_blank"
                       href="{{ MEDIA_URL }}{{ attachment.attachment }}">{{ attachment.description }}</a>
                    <button class="close delete-attachment" data-type="sales" data-id="{{ attachment.id }}">
                        <span class="icon-trash"></span>
                    </button>
                </div>
                {% endfor %}
            </div>
            <hr>
            <div class="attach_file_field">
                <label>
                    <b>Add File: </b>
                    <input type="file" name="attachments" required class="attachments" id="sales-attachment"/>
                </label>
                <label>
                    <b>Description: </b>
                    <input type="text" name="captions" required class="captions">
                </label>
                <label>
                    <b>Clear Attachment: </b>
                    <input class="btn btn-warning" type="button" value="Clear" id="clear-sales-attachment" />
                </label>
            </div>

            <p><br><input type="button" class="btn add_file" value="Add Another File"/>
                <input type="submit" value="Save" class="btn" id="ensure-sales-attachment"/>
            </p>
        </form>
    </div>
    <div id="purchase_attach" class="tab-pane">
        <form class="attachment-form" data-type="purchase">
            <div class="row-fluid">
                {% for attachment in purchase_attachments %}
                <div class="span3">
                    <a target="_blank"
                       href="{{ MEDIA_URL }}{{ attachment.attachment }}">{{ attachment.description }}</a>
                    <button class="close delete-attachment" data-type="purchase"
                            data-id="{{ attachment.id }}">
                        <span class="icon-trash"></span>
                    </button>
                </div>
                {% endfor %}
            </div>
            <br>

            <div class="attach_file_field">
                <label>
                    <b>Add File: </b>
                    <input type="file" name="attachments" required class="attachments" id="purchase-attachment"/>
                </label>
                <label>
                    <b>Description: </b>
                    <input type="text" name="captions" required class="captions">
                </label>
                <label>
                    <b>Clear Attachment: </b>
                    <input class="btn btn-warning" type="button" value="Clear" id="clear-purchase-attachment" />
                </label>
            </div>

            <p><input type="button" class="btn add_file" value="Add Another File"/>
                <input type="submit" value="Save" class="btn" id="ensure-purchase-attachment"/></p>

        </form>
    </div>
    <div id="bank_attach" class="tab-pane">
        <form class="attachment-form" data-type="bank">
            <div class="row-fluid">
                {% for attachment in bank_attachments %}
                <div class="span3">
                    <a target="_blank"
                       href="{{ MEDIA_URL }}{{ attachment.attachment }}">{{ attachment.description }}</a>
                    <button class="close delete-attachment" data-type="bank" data-id="{{ attachment.id }}">
                        <span class="icon-trash"></span>
                    </button>
                </div>
                {% endfor %}
            </div>
            <br>

            <div class="attach_file_field">
                <label>
                    <b>Add File: </b>
                    <input type="file" name="attachments" required class="attachments" id="bank-attachment"/>
                </label>
                <label>
                    <b>Description: </b>
                    <input type="text" name="captions" required class="captions">
                </label>
                <label>
                    <b>Clear Attachment: </b>
                    <input class="btn btn-warning" type="button" value="Clear" id="clear-bank-attachment" />
                </label>
            </div>

            <p><input type="button" class="btn add_file" value="Add Another File"/>
                <input type="submit" value="Save" class="btn" id="ensure-bank-attachment"/></p>
        </form>
    </div>
    <div id="other_attach" class="tab-pane">
        <form class="attachment-form" data-type="other">
            <div class="row-fluid">
                {% for attachment in other_attachments %}
                <div class="span3">
                    <a target="_blank"
                       href="{{ MEDIA_URL }}{{ attachment.attachment }}">{{ attachment.description }}</a>
                    <button class="close delete-attachment" data-type="other" data-id="{{ attachment.id }}">
                        <span class="icon-trash"></span>
                    </button>
                </div>
                {% endfor %}
            </div>
            <br>

            <div class="attach_file_field">
                <label>
                    <b>Add File: </b>
                    <input type="file" name="attachments" required class="attachments" id="other-attachment"/>
                </label>
                <label>
                    <b>Description: </b>
                    <input type="text" name="captions" required class="captions">
                </label>
                <label>
                    <b>Clear Attachment: </b>
                    <input class="btn btn-warning" type="button" value="Clear" id="clear-other-attachment" />
                </label>
            </div>

            <p><input type="button" class="btn add_file" value="Add Another File"/>
                <input type="submit" value="Save" class="btn" id="ensure-other-attachment"/>
            </p>
        </form>
    </div>
</div>
</div>
<!-- EO Attachment Tabs -->
</div>

<script>
if({{ approved }} == 1){
    $(':button').attr('disabled', true);
    $(':input').attr('disabled', true);
    $('#day-journal-date').removeAttr('disabled');
    $('#day-journal-selection-button').removeAttr('disabled');
    $('.btn-danger').hide();
    }
//move arrow up and down
$(document).click(function(){
arrow_handling();
});

</script>

<script type="text/javascript">
            $('.date-picker').datepicker({
                endDate:'0d',
                format: 'mm/dd/yyyy',

            });
            $(document).ready(function(){
                $('.mytable').hide();
                    $('#0').show();

        })

           $('#day-journal-date').click(function(){
                $('div.datepicker').removeAttr('style');
                $('div.datepicker').css({
                    'display': 'block',
                     'top': '229px',
                      'left': '992px'
                });
           });
        $("#day-journal-selection-button").click(function(){
            var a = $("#day-journal-date").val();
            if(a!='undefined' && a!=""){
                a = a.split('/');
                var temp = a[2]+'-'+a[0]+'-'+a[1];
                window.location = "/day/"+temp;
            }
            else{
                //$("#day-journal-date").datepicker('update', new Date());
                window.location = "/day/";
            }

        })
</script>
{% endblock %}
